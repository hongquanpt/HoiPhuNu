
@{
     ViewBag.Title = "Report";
     if (Session["Quyen"].ToString() == "1")
     {
          Layout = "~/Views/Shared/_LayoutQuanTriCapHV.cshtml";
     }
     else if (Session["Quyen"].ToString() == "2")
     {
          Layout = "~/Views/Shared/_LayoutQuanTriCapHoi.cshtml";
     }
}
@*@using (Html.BeginForm("Gen", "Report", FormMethod.Post))
{*@
     <form>
          <div id="page-wrapper">
               <div class="row">

                    <div class="col-lg-12 no-print d-flex " style="padding-top:40px;">
                         <div class="col-lg-3 no-print">
                              <a class="btn btn-danger text-uppercase text-end px-3" style="margin-right: 20px;" href="@Url.Action("Index","ThongKe")"> Quay lại</a>

                              @*<div class="form-group col-lg-4  text-uppercase text-left" style="padding: 5px 5px;">
                                        <label>Tính Đến</label>
                                   </div>
                                   <div class="form-group col-lg-8 ">
                                        <select class="form-control">
                                             <option value="AL">Tháng 1/2020 </option>
                                             <option value="WY">Tháng 1/2021</option>
                                             <option value="WY">Tháng 1/2022</option>
                                        </select>
                                   </div>*@
                         </div>

                         <div class="col-lg-6 no-print">

                              @*<div class="form-group col-lg-9 text-uppercase text-left" style="padding: 5px 5px;color:red">
                                        <label>Lưu Lịch Sử Văn Bản&emsp;</label>
                                        <label>
                                             <input type="checkbox" value="">
                                        </label>
                                   </div>
                                   <div class="form-group col-lg-3" style="padding: 5px 5px;">

                                   </div>*@
                         </div>

                         <div class="col-lg-3 no-print">
                              <div style="margin-left: 82px;">
                                   <a href="@Url.Action("TaiBaoCao","Report")" class="btn btn-raised btn-primary text-uppercase">
                                        <i class="fas fa-download"></i>Tải Xuống
                                   </a>
                                   <a onclick="printContent()" class="btn btn-danger text-uppercase text-end px-3" href=""><i class="fas fa-print"></i> In</a>
                              </div>
                         </div>
                         @*<div>
                                   <button class="btn btn-raised btn-warning text-uppercase" onclick="printContent()">In</button>
                              </div>*@

                    </div>
                    <div style="background-color:white; width: 900px; margin: auto; padding-top:30px">
                         <div style="margin-right: 50px ;margin-left: 50px;">
                              <div style="all:initial">
                                   @Html.Raw(ViewBag.DocumentContent)
                              </div>
                         </div>
                    </div>
               </div>
          </div>
          <script>
               document.addEventListener('keydown', function (event) {
                    // Kiểm tra nếu phím Ctrl (event.ctrlKey) và phím P (event.key === 'p') được nhấn cùng lúc
                    if (event.ctrlKey && event.key === 'p') {
                         event.preventDefault();
                         printContent()
                         // Ngăn chặn hành động mặc định của phím Ctrl + P
                         //alert('Bạn đã nhấn Ctrl + P');
                         //// Gọi hàm xử lý khi người dùng nhấn Ctrl + P ở đây
                    }
               });
               function printContent() {
                    // Ẩn phần không cần in trước khi in
                    var noPrintElements = document.getElementsByClassName('no-print');
                    for (var i = 0; i < noPrintElements.length; i++) {
                         noPrintElements[i].style.display = 'none';
                    }

                    // In trang
                    window.print();

                    // Hiển thị lại phần không cần in sau khi in xong
                    for (var i = 0; i < noPrintElements.length; i++) {
                         noPrintElements[i].style.display = 'block';
                    }
               }
          </script>
          @*<script>
                    document.addEventListener('contextmenu', function (event) {
                         // Ngăn chặn xuất hiện menu ngữ cảnh mặc định
                         event.preventDefault();

                         // Tạo một menu ngữ cảnh tùy chỉnh
                         var contextMenu = document.createElement('div');
                         contextMenu.style.position = 'absolute';
                         contextMenu.style.background = 'white';
                         contextMenu.style.border = '1px solid #ccc';
                         contextMenu.style.padding = '5px';
                         contextMenu.style.left = event.clientX + 'px';
                         contextMenu.style.top = event.clientY + 'px';

                         // Thêm tùy chọn "In" vào menu ngữ cảnh
                         var printOption = document.createElement('div');
                         printOption.textContent = 'In';
                         printOption.style.cursor = 'pointer';
                         printOption.onclick = function () {
                              printContent()
                              // Xử lý khi người dùng chọn tùy chọn "In"
                           /*   alert('Bạn đã chọn tùy chọn In');*/
                              // Gọi hàm xử lý khi người dùng chọn tùy chọn "In" ở đây
                              // Ví dụ: window.print();
                              contextMenu.remove(); // Loại bỏ menu ngữ cảnh sau khi xử lý
                         };
                         contextMenu.appendChild(printOption);

                         // Thêm menu ngữ cảnh vào thân tài liệu
                         document.body.appendChild(contextMenu);

                         // Bắt sự kiện click chuột để đóng menu ngữ cảnh khi người dùng kích vào nơi khác
                         document.addEventListener('click', function () {
                              contextMenu.remove();
                         });
                    });
               </script>*@

     </form>
     @*<div class="row col-lg-12 no-print" style="background: white; float: right; width: 83%; border-left: 1px solid #ededed ">
               <div class="col-lg-6">
               </div>
               <div class="d-flex justify-content-end col-lg-4" style="margin-bottom: 20px;">
                    <a class="btn btn-danger text-uppercase text-end px-3" style="margin-right: 20px;" href="~/Member/Index" type="submit"> Quay lại</a>
               </div>
          </div>*@


@*}*@
